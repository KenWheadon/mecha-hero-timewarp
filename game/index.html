<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mecha Hero - Mini Jam 197: Recursion</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="overlay"></div>
    <div id="onboarding-popup">
      <div id="onboarding-content">
        <h3 id="onboarding-title"></h3>
        <p id="onboarding-text"></p>
        <button id="onboarding-close">Got it!</button>
      </div>
    </div>
    <div id="how-to-play">
      <button id="close-htp">&times;</button>
      <h2>How to Play</h2>

      <div class="htp-intro">
        <p>
          Counter the enemy mecha's attacks before time runs out! Each fight
          gets harder with more poses and less time.
        </p>
      </div>

      <div class="htp-section">
        <h3>Basic Gameplay</h3>
        <div class="htp-card">
          <div class="htp-icon">‚öîÔ∏è</div>
          <div class="htp-content">
            <strong>Watch & Counter</strong>
            <p>
              Enemy shows an attack pose, you respond with the correct counter
              move
            </p>
          </div>
        </div>
        <div class="htp-card">
          <div class="htp-icon">‚è±Ô∏è</div>
          <div class="htp-content">
            <strong>Beat the Timer</strong>
            <p>Each fight gives you less time per pose: 10s ‚Üí 6s ‚Üí 4s ‚Üí 2s</p>
          </div>
        </div>
        <div class="htp-card">
          <div class="htp-icon">üíî</div>
          <div class="htp-content">
            <strong>3 Hearts Only</strong>
            <p>
              Wrong answer or timeout costs 1 heart. Lose all 3 and it's game
              over
            </p>
          </div>
        </div>
      </div>

      <div class="htp-section">
        <h3>Fight Progression</h3>
        <div class="htp-fight-grid">
          <div class="htp-fight-card fight-1">
            <div class="fight-number">Fight 1</div>
            <div class="fight-detail">2 Poses</div>
            <div class="fight-detail">2 Enemy HP</div>
            <div class="fight-detail">10s Timer</div>
          </div>
          <div class="htp-fight-card fight-2">
            <div class="fight-number">Fight 2</div>
            <div class="fight-detail">4 Poses</div>
            <div class="fight-detail">4 Enemy HP</div>
            <div class="fight-detail">6s Timer</div>
          </div>
          <div class="htp-fight-card fight-3">
            <div class="fight-number">Fight 3</div>
            <div class="fight-detail">4 Poses</div>
            <div class="fight-detail">4 Enemy HP</div>
            <div class="fight-detail">4s Timer</div>
          </div>
          <div class="htp-fight-card fight-4">
            <div class="fight-number">Fight 4</div>
            <div class="fight-detail">8 Poses</div>
            <div class="fight-detail">8 Enemy HP</div>
            <div class="fight-detail">2s Timer</div>
          </div>
        </div>
      </div>

      <div class="htp-section">
        <h3>Special Mechanics</h3>
        <div class="htp-mechanic">
          <strong>Crystal Energy</strong>
          <p>Powers time warps between fights 2-3. Starts with 2 charges.</p>
        </div>
        <div class="htp-mechanic">
          <strong>Time Warps</strong>
          <p>
            After winning fights 1-3, watch a 5s warp animation before the next
            battle.
          </p>
        </div>
        <div class="htp-mechanic">
          <strong>Pause Anytime</strong>
          <p>Need a break? Hit pause to freeze the action.</p>
        </div>
      </div>

      <div class="htp-footer">
        <p>
          Remember: Recursion rules this arena. Patterns echo and accelerate!
        </p>
      </div>
    </div>

    <div id="title-screen">
      <h1 id="title">MECHA HERO</h1>
      <p>Mini Jam 179: Recursion</p>
      <div class="button-container">
        <div class="start-btn-wrapper">
          <button class="title-btn" id="start-btn">Start Game</button>
          <div id="high-score">
            <div class="high-score-time">
              Best Time: <span id="high-score-value">N/A</span>
            </div>
            <div class="high-score-stars">
              <div class="star-small" data-star="1"></div>
              <div class="star-small" data-star="2"></div>
              <div class="star-small" data-star="3"></div>
            </div>
            <div id="star-progress-message" class="star-progress"></div>
          </div>
        </div>
      </div>
      <div class="bottom-row">
        <button class="title-btn audio-toggle-btn" id="audio-toggle-title">
          <img src="images/icon-musicnote.png" alt="Audio" class="audio-icon" />
        </button>
        <button class="title-btn htp-icon-btn" id="htp-btn">?</button>
      </div>
    </div>

    <div id="game">
      <!-- Top Bar: Hearts, Fight Info, Controls -->
      <div id="top-bar">
        <div id="hearts"></div>
        <div id="fight-info">Fight: 1/4</div>
        <div id="controls">
          <button id="audio-toggle-combat" class="audio-toggle-btn">
            <img
              src="images/icon-musicnote.png"
              alt="Audio"
              class="audio-icon"
            />
          </button>
          <button id="pause">Pause</button>
        </div>
      </div>

      <!-- Timer -->
      <div id="timer">
        <div id="timer-paused">PAUSED</div>
        <div id="timer-text"></div>
        <div id="timer-fill"></div>
      </div>

      <!-- Enemy Section: Status Bars + Pose -->
      <div id="enemy-section">
        <div id="status-bars">
          <div id="crystal-energy"><div id="crystal-fill"></div></div>
          <div id="enemy-hp"><div id="enemy-hp-fill"></div></div>
        </div>
        <div id="enemy-container">
          <div id="enemy-pose">
            <img
              id="pose-img"
              src="images/pose1.png"
              alt="Enemy Pose"
              onerror="console.error('Missing image: ' + this.src)"
            />
          </div>
        </div>
      </div>

      <!-- Instruction and Message -->
      <div id="instruction">Prepare for battle...</div>
      <div id="message"></div>

      <!-- Attacks Section -->
      <div id="attacks-section">
        <div id="attacks">
          <button class="attack-btn" data-action="shield">
            <img
              src="images/shield.png"
              alt="Shield"
              onerror="console.error('Missing image: ' + this.src)"
            />
            Shield Bash
          </button>
          <button class="attack-btn" data-action="rocket">
            <img
              src="images/rocket.png"
              alt="Rocket"
              onerror="console.error('Missing image: ' + this.src)"
            />
            Rocket Fist
          </button>
          <button class="attack-btn" data-action="sword">
            <img
              src="images/sword.png"
              alt="Sword"
              onerror="console.error('Missing image: ' + this.src)"
            />
            Robo Bat
          </button>
          <button class="attack-btn" data-action="plasma">
            <img
              src="images/plasma.png"
              alt="Plasma"
              onerror="console.error('Missing image: ' + this.src)"
            />
            Plasma Glasses
          </button>
        </div>
      </div>

      <!-- Restart Button -->
      <button id="restart">Restart Game</button>
    </div>

    <!-- Victory Screen -->
    <div id="victory-screen">
      <div class="game-over-container">
        <h1 class="game-over-title victory-title">VICTORY!</h1>
        <div class="game-over-subtitle">All Enemies Defeated</div>

        <div class="victory-content">
          <div id="victory-badge" class="high-score-badge">NEW RECORD!</div>
          <div class="time-display">
            <div class="time-label">Your Time</div>
            <div id="victory-time" class="time-value">0:00.00</div>
          </div>
          <div class="star-rating">
            <div class="star" data-star="1"></div>
            <div class="star" data-star="2"></div>
            <div class="star" data-star="3"></div>
          </div>
          <div class="victory-message">
            The mecha threat has been neutralized.<br>
            Time flows freely once more!
          </div>
        </div>

        <button class="game-over-restart">Play Again</button>
      </div>
    </div>

    <!-- Defeat Screen -->
    <div id="defeat-screen">
      <div class="game-over-container">
        <h1 class="game-over-title defeat-title">DEFEATED</h1>
        <div class="game-over-subtitle">Systems Overloaded</div>

        <div class="defeat-content">
          <div class="fight-reached">
            <div class="fight-label">Fight Reached</div>
            <div id="defeat-fight" class="fight-value">1</div>
          </div>
          <div class="defeat-message">
            Your mecha has fallen.<br>
            The time loop continues...
          </div>
        </div>

        <button class="game-over-restart">Try Again</button>
      </div>
    </div>

    <script type="module">
      import { initTitleScreen } from "./title-screen.js";

      // Initialize title screen on page load
      initTitleScreen();
    </script>
  </body>
</html>
